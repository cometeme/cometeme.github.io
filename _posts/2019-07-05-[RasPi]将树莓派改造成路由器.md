---
layout: post
title: '[RasPi] 将树莓派改造成路由器'
subtitle: '畅快地使用校园网'
date: 2019-07-05
categories: RasPi
cover: '/assets/image/RaspAP-header.png'
tags: RasPi
---

最近搬到了一个新的实验室，校园无线网的连接质量十分不好，网页经常需要加载很久，有时候甚至刷新不出 CSS 文件。不过有线网的质量到还可以，但是笔记本拖一根网线多少也有些不方便，而且也没法给手机共享网络。

所以我一直有在实验室中装一个路由器的想法。平时校园网只支持同时登陆两台设备，经常会出现几台设备相互挤的情况。而如果使用路由器的话，就只会占用一台设备，而可以给所有设备提供热点了了，而且也会比直连校园无线网要快一些。

但是这里就遇到了一个问题：我们学校的校园网需要在一个网页上登陆后才能使用，而经过测试，普通的路由器连接上这样的网络之后，设备连到路由器上还是需要登陆，这样就不够方便。传统的路由器并不能在其中直接登陆校园网的网页，所以我想到了 [OpenWrt](https://openwrt.org) —— 一个 Linux 版本的路由器系统，这样就能够在路由器中先登录页面，再发送 Wi-Fi 信号。

不过安装 OpenWrt 需要刷机，而且支持 OpenWrt 的路由器并不多。不过我在 OpenWrt 官方的兼容设备列表中看到了树莓派，刚好我手中有一个被“尘封已久”的树莓派 3B ，之前做了一个离线下载的服务器，无奈串口的速度实在是太慢，并不能很快地下载，所以暂时搁置了。现在终于可以再次发挥作用了。

不过为了偷懒，我还是不想刷成 OpenWrt 系统，因为这样之后要继续开发一些新功能的话就会比较繁琐。在研究了一番之后，我发现在原生的 Raspbian 系统中就可以创建热点，并且也有比较好的性能。最终，我在 GitHub 上找到了 [raspap-webgui](https://github.com/billz/raspap-webgui) 这一个项目，它不仅仅安装非常方便，而且还自带了一个路由管理页面。话不多说，先让我们看看它是怎么安装的：

### 1. RaspAP 的安装

首先我们先给树莓派连上网线，登录一下网络，

在设备连上网络后，我们只需要在终端中输入以下的一行代码，就可以开始安装：

```bash
wget -q https://git.io/voEUQ -O /tmp/raspap && sudo bash /tmp/raspap
```

在安装过程中，需要我们回答几个问题，例如是否需要安装 Web 管理页面之类的，这里建议选择 Y ，因为有了 Web 管理界面之后会变得方便很多。在安装完成之后，它会提示我们重新启动。

至此，我们就已经成功安装了 RaspAP ，十分简单方便。此时我们只需要静候树莓派重启完毕，就可以进入下一个步骤了。

### 2. 配置 RaspAP

在默认的安装方式下， RaspAP 的服务会在系统开启时自动打开。所以等到树莓派开机后，我们就能够在其他设备的 Wi-Fi 列表中看到 `raspi-webgui` ，而它默认的密码为 `ChangeMe` 。

连接上热点之后，其实我们就能够上网了。不过直接使用默认的密码并不安全。所以我们打开浏览器，输入 `10.3.141.1` ，就可以打开路由器的管理页面。默认的账号为 `admin` ，密码是 `secret` 。

在这个管理页面中，你就可以任意地配置你的路由器了。例如你可以修改热点的名称、密码和加密方式，也建议修改一下管理系统的密码。在这个管理页面里，甚至还可以查看当前连接的设备，每小时使用的流量，以及可以远程关机和重启路由器。

### 结语

通过非常简单的方法，我们就能够将树莓派改造成路由器。也算是解决了我在实验室上网的难题。

当然，使用板载的无线网卡，信号强度和速度可能并不会很好。所以如果有需要的话，可以考虑加装外接的无线网卡，提升网络的质量。不过树莓派 3B 只有 2.0 的接口，而新发售的树莓派 4 有两个 3.0 的接口，速度会更快一些。之后也可以考虑用树莓派做一个路由 + NAS 一体的路由器，拓展它的功能。

总之，树莓派的可拓展能力很强，路由器也仅仅只是它可以做的一小部分，而具体的应用完全是由你的想象决定的，所以也希望能够看到大家用树莓派做出更多有趣的作品。