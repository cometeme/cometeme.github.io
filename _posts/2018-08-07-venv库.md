---
layout: post
title: 'venv 库'
subtitle: '创建一个轻量化的虚拟环境'
date: 2018-08-07
categories: python官方库
cover: '../../../assets/img/venv-header.jpeg'
tags: python python库
---

在使用 python 制作网页的过程中，我们往往需要先将网页的文件“**虚拟化**”。虚拟化其实就是将当前文件下程序的运行环境与整个系统的环境隔离。那么为什么我们要将一个项目虚拟化呢？

### 1.不进行虚拟化会产生的问题

在使用 python 时，有几个常见的问题，大家也许都会碰见：

1.当运行的项目处于不同版本时（如 python 2.7/3.7 ），要通过切换 python 解释器的版本来运行程序（或要使用 `python2/3` `pip/pip3` 等指令来对应不同的版本）。

2.有时做一个项目要用到许多第三方库，但是其他项目基本不会用。如果直接 `pip install` 到系统中，项目删除后清除安装过的库会很麻烦。

3.做完一个项目后，你希望能够不再一次安装它依赖的库，就能在另外一个系统上直接运行。

4.你的项目暂时运行在一个旧版的第三方库上，而新版的第三方库不兼容你所写的程序。你既希望能够让原来的项目在旧版本上继续正常运行，又希望能够在另一个项目中使用新版本。

如果你遇到过上面这四个问题，并且希望能够改善这一些繁琐的配置过程，那么你就可以尝试对你的项目进行“**虚拟化**”。

### 2.创建一个虚拟化项目

python 自带了一个非常简便的虚拟化库 - venv 。在 python 3.5 及之前的版本，创建一个虚拟化项目的指令为：

```python
  python -m venv <directory>
```

而在 3.6 之后的版本中，指令变成了

```python
  python3 -m venv <directory>
```

其中在 3.4 及之前的版本中，初始化一个环境是**不会自带 pip** 的。而在 3.4 之后，可以添加 `--without-pip` 这个参数来去掉 pip 包。

当然，venv还有 `--copies` 参数，它就可以在创建时把系统已有的库复制进去。不过一般这个不常用。（因为系统里装的库可能已经很多了）

### 3.进入虚拟化环境

成功创建了虚拟化的环境之后，我们需要先**进入**这个环境（不然 pip 还是会装在项目外面）。我们可以使用以下指令来进入环境。其中 `<venv>` 是你项目文件夹的路径。


- MacOS 或 Linux

  - bash/zsh	`$ source <venv>/bin/activate`

  - fish	`$ . <venv>/bin/activate.fish`
  
  - csh/tcsh	`$ source <venv>/bin/activate.csh`

- Windows

  - cmd.exe	`C:\> <venv>\Scripts\activate.bat`

  - PowerShell	`PS C:\> <venv>\Scripts\Activate.ps1`
  
```python
  cometeme$ source /Users/cometeme/Documents/example/bin/activate
  (example)cometeme$ 
```

可以看到前面多了一个(example)的提示，说明我们已经进入到虚拟环境中了。



